(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[335],{3734:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/twitter/[id]",function(){return s(3185)}])},3185:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var n=s(7458),a=s(2983),i=s(3389),l=s(8317),o=s.n(l),r=s(3070);function c(e){let{postId:t,authorId:s}=e,[i,l]=(0,a.useState)([]),[o,r]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),u=async()=>{try{let e=await fetch("/api/comments/".concat(t)),s=await e.json();l(s.comments||[])}catch(n){console.error("Failed to load comments",n)}};(0,a.useEffect)(()=>{t&&u()},[t]);let m=async e=>{e.preventDefault();try{d(!0);let n=await fetch("/api/comments/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:t,authorId:s,content:o})}),a=await n.json();n.ok?(r(""),await u(),console.log(a)):console.error("Error posting comment:",a.error)}catch(i){console.error("Submit failed:",i)}finally{d(!1)}};return(0,n.jsxs)("div",{className:"mt-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Comments"}),(0,n.jsxs)("form",{onSubmit:m,className:"flex items-center gap-2 mb-4",children:[(0,n.jsx)("input",{type:"text",value:o,onChange:e=>r(e.target.value),placeholder:"Add a comment...",className:"flex-1 border rounded px-3 py-2",disabled:c}),(0,n.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",disabled:c,children:c?"Posting...":"Post"})]}),(0,n.jsxs)("ul",{children:[0===i.length&&(0,n.jsx)("li",{className:"text-gray-500",children:"No comments yet."}),i.map(e=>{var t;return(0,n.jsxs)("li",{className:"border-b py-2",children:[(0,n.jsxs)("strong",{children:[(null===(t=e.author)||void 0===t?void 0:t.username)||"Anonymous",":"]})," ",e.content]},e.id)})]})]})}var d=s(2058);function u(){var e;let t=(0,i.useRouter)(),{id:s}=t.query,[l,u]=(0,a.useState)(null),[m,h]=(0,a.useState)(null),[x,p]=(0,a.useState)(null),[f,w]=(0,a.useState)(!1),[b,g]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!t.isReady)return},[t.isReady]),(0,a.useEffect)(()=>{let e=localStorage.getItem("token");p(e)},[]);let N=async e=>{try{let t=await fetch("/api/twitter/".concat(e),{method:"GET"});if(!t.ok){console.error("Something went wrong");return}let s=await t.json();u(s.post)}catch(n){console.error("Note info could not be fetched",n)}},k=async(e,t)=>{j(!0);try{let s=await fetch("/api/twitter/like",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:e,userId:t})});s.ok?(await N(e),g(!0)):alert("Something went wrong")}catch(n){console.log(n)}finally{j(!1)}},S=async(e,t)=>{j(!0);try{let s=await fetch("/api/twitter/dislike",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:e,userId:t})});s.ok?(await N(e),g(!1)):alert("Something went wrong")}catch(n){console.error(n)}finally{j(!1)}};return((0,a.useEffect)(()=>{if(!t.isReady||!s||!x)return;let e=async()=>{let e=await (0,r.b)(x);h(e),await N(String(s))};e()},[t.isReady,s,x]),(0,a.useEffect)(()=>{if(l&&m){var e;w(l.authorId===m.id);let t=null===(e=l.likes)||void 0===e?void 0:e.some(e=>e.userId===m.id);g(!!t)}},[l,m]),l&&m)?(0,n.jsxs)("div",{className:"min-h-screen bg-[#15202B] py-10 px-4 sm:px-6 lg:px-8 text-white",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-8 text-center text-white",children:"\uD83D\uDCDC Post Details"}),(0,n.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6 bg-[#1E2732] p-6 rounded-2xl shadow",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold text-white mb-4",children:l.title}),(0,n.jsxs)("p",{className:"text-white mb-4",children:["Content: ",l.content]}),(0,n.jsxs)("p",{className:"text-white mb-4",children:["Author: ",m.username||"Unknown"]}),(0,n.jsxs)("p",{className:"text-white mb-4",children:["Likes: ",(null===(e=l.likes)||void 0===e?void 0:e.length)||0]}),l.imageUrl&&(0,n.jsx)("img",{src:l.imageUrl,alt:"Post Image",className:"w-full h-[300px] object-cover rounded-lg mb-6"}),f&&(0,n.jsx)(o(),{href:{pathname:"/twitter/edit/".concat(l.id)},className:"mt-4 px-6 py-3 bg-blue-500 text-white rounded-lg text-center block",children:"Edit Post"}),(0,n.jsxs)("div",{className:"flex justify-between mt-4",children:[b?(0,n.jsx)("button",{onClick:()=>S(l.id,m.id),className:"px-6 py-3 bg-red-500 text-white rounded-lg w-[48%]",disabled:y,children:y?"Loading...":"Dislike"}):(0,n.jsx)("button",{onClick:()=>k(l.id,m.id),className:"px-6 py-3 bg-emerald-500 text-white rounded-lg w-[48%]",disabled:y,children:y?"Loading...":"Like"}),(0,n.jsx)("button",{onClick:()=>t.push("/twitter"),className:"px-6 py-3 bg-blue-500 text-white rounded-lg w-[48%]",children:"Back to Feed"})]}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)(c,{postId:String(l.id),authorId:m.id})})]})]}):(0,n.jsx)(d.Z,{})}function m(){return(0,n.jsx)(u,{})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=3734)}),_N_E=e.O()}]);